<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rt2_assignment1: Research Track 2 - First Assignment 4482512 Enrico Fiasche&#39; (Robotics Engineering / JEMARO, Unige)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rt2_assignment1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Research Track 2 - First Assignment 4482512 Enrico Fiasche' (Robotics Engineering / JEMARO, Unige) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
General information</h1>
<p>The assignment requires developing a software architecture for the control of a robot in the environment. The two cpp files must be written in ROS2, as components, so that using ros1_bridge, they can be interfaces with ROS nodes. During the simulation, the user can press "1" to give a random goal to the robot, and then press "0" to stop the robot.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Launch the simulation</h1>
<h2><a class="anchor" id="autotoc_md3"></a>
Simulation with Gazebo</h2>
<p>The package contains the cpp nodes written in ROS2. To run correctly the simulation you must have two additional packages, which are <b>ros1_bridge</b> and <b><a class="el" href="namespacert2__assignment1.html">rt2_assignment1</a></b>, which contains the two nodes in ROS and the gazebo simulation. To launch quickly all the simulation there is a script <b>gazeboScript.sh</b> that must be launched in the <em>root</em> folder. Before launching the script please check that you have installed <b>gnome-terminal</b> in your terminal. To install this new command, please run: </p><div class="fragment"><div class="line">sudo apt-get install gnome-terminal</div>
</div><!-- fragment --><p>Now you can launch the simulation in two different way:</p><ul>
<li>running each launch file on different terminals. <br  />
 You need three different terminal. In the first one, used to launch ROS nodes, you have to source your ROS workspace (or sourcing directly ros.sh): <div class="fragment"><div class="line">source path_your_ros_workspace/devel/setup.bash</div>
</div><!-- fragment --></li>
</ul>
<p>Then you have to launch the gazeboSim (in the ROS workspace, you can use the branch main to run it), please run: </p><div class="fragment"><div class="line">roslaunch rt2_assignment1 gazeboSim.launch</div>
</div><!-- fragment --><p>In the second one, used to run the ros bridge, you have to source ROS and ROS2 workspace (or sourcing directly ros12.sh): </p><div class="fragment"><div class="line">source path_your_ros_workspace/devel/setup.bash</div>
<div class="line">source /opt/ros/foxy/setup.bash</div>
<div class="line">source path_your_ros2_workspace/install/setup.bash</div>
</div><!-- fragment --><p>Then you have to run the ros1_bridge (in the ROS2 workspace), please run: </p><div class="fragment"><div class="line">ros2 run ros1_bridge dynamic_bridge</div>
</div><!-- fragment --><p>In the last one, used to launch the ros2 components, you have to source your ROS2 workspace (or sourcing directly ros2.sh): </p><div class="fragment"><div class="line">source /opt/ros/foxy/setup.bash</div>
<div class="line">source path_your_ros2_workspace/install/setup.bash</div>
</div><!-- fragment --><p>Then you have to launch the components (in the ROS2 workspace), please run: </p><div class="fragment"><div class="line">ros2 launch rt2_assignment1 my_launch.py</div>
</div><!-- fragment --><ul>
<li>using only the script. <br  />
 You can run directly the script <b>gazeboScript.sh</b>. Before running the script please check if the path of the workspaces are correctly defined. To launch the script, please run: <div class="fragment"><div class="line">./gazeboScript.sh</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
Simulation with VRep</h2>
<p>You can also run the simulation using <b>VRep</b>. To run correctly the simulation you must have two additional packages, which are <b>ros1_bridge</b> and <b><a class="el" href="namespacert2__assignment1.html">rt2_assignment1</a></b>, which contains the two nodes in ROS, and you must have CoppeliaSim in your machine. To launch quickly all the simulation there is a script <b>vrepScript.sh</b> that must be launched in the <em>root</em> folder. Before launching the script please check that you have installed <b>gnome-terminal</b> in your terminal. To install this new command, please run: </p><div class="fragment"><div class="line">sudo apt-get install gnome-terminal</div>
</div><!-- fragment --><p>Before running the codes you need to open CoppeliaSim and the correct scene. You need two different terminal to run the scene. In the first one you have to source your ROS workspace (or sourcing directly ros.sh) and run roscore node: </p><div class="fragment"><div class="line">source path_your_ros_workspace/devel/setup.bash</div>
<div class="line">roscore</div>
</div><!-- fragment --><p>In the second terminal you need to source your ROS workspace and run CoppeliaSim: </p><div class="fragment"><div class="line">source path_your_workspace/devel/setup.bash</div>
<div class="line">cd path_CoppeliaSim/</div>
<div class="line">./coppeliaSim.sh</div>
</div><!-- fragment --><p>When the CoppeliaSim program is running, open the scene "vrepSceneR2D2.ttt" inside the <a class="el" href="namespacert2__assignment1.html">rt2_assignment1</a> package and start the simulation pressing play. Now you can launch the simulation in two different way:</p><ul>
<li>running each launch file on different terminals. <br  />
 You need three different terminal. In the first one, used to launch ROS nodes, you have to source your ROS workspace (or sourcing directly ros.sh): <div class="fragment"><div class="line">source path_your_ros_workspace/devel/setup.bash</div>
</div><!-- fragment --></li>
</ul>
<p>Then you have to launch the vrepSim (in the ROS workspace, you can use the branch main to run it), please run: </p><div class="fragment"><div class="line">roslaunch rt2_assignment1 vrepSim.launch</div>
</div><!-- fragment --><p>In the second one, used to run the ros bridge, you have to source ROS and ROS2 workspace (or sourcing directly ros12.sh): </p><div class="fragment"><div class="line">source path_your_ros_workspace/devel/setup.bash</div>
<div class="line">source /opt/ros/foxy/setup.bash</div>
<div class="line">source path_your_ros2_workspace/install/setup.bash</div>
</div><!-- fragment --><p>Then you have to run the ros1_bridge (in the ROS2 workspace), please run: </p><div class="fragment"><div class="line">ros2 run ros1_bridge dynamic_bridge</div>
</div><!-- fragment --><p>In the last one, used to launch the ros2 components, you have to your ROS2 workspace (or sourcing directly ros2.sh): </p><div class="fragment"><div class="line">source /opt/ros/foxy/setup.bash</div>
<div class="line">source path_your_ros2_workspace/install/setup.bash</div>
</div><!-- fragment --><p>Then you have to launch the components (in the ROS2 workspace), please run: </p><div class="fragment"><div class="line">ros2 launch rt2_assignment1 my_launch.py</div>
</div><!-- fragment --><ul>
<li>using only the script. <br  />
 You can run directly the script <b>gazeboScript.sh</b>. Before running the script please check if the path of the workspaces are correctly defined. To launch the script, please run: <div class="fragment"><div class="line">./vrepScript.sh</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Nodes and program description</h1>
<p>In this package there are two different components used to achieve the goal required by the assignment. The programs are written in C++:</p><ul>
<li>The first one, <b><a class="el" href="random__point__server_8cpp.html">random_point_server.cpp</a></b>, which is a ROS2 server component that generates three random numbers. This node uses the service message RandomPosition which has as request the minimum and maximum value allowed for the x and y position, and it has as response the three coordinates of the random goal (x,y posiion and the orientation theta).</li>
<li>The second one, <b><a class="el" href="state__machine_8cpp.html">state_machine.cpp</a></b>, which is a ROS2 component used to communicate with the other nodes. This one has two different client, one which is connected to the <b><a class="el" href="random__point__server_8cpp.html">random_point_server.cpp</a></b> in order to receive the next goal, the other one which is used to send new goals and to check if a target is reached, and a server, which receives the request done by the user through the <em>user_interface.py</em>. When the <b>state_machine</b> received a Command request from a client, if the user command is "start" the component start a function that makes a request to <b><a class="el" href="random__point__server_8cpp.html">random_point_server.cpp</a></b> receiving a goal between -5.0 and 5.0, regarding x and y position, and the theta orientation, then the state machine sends this goal making a request to <b>go_to_point</b> server and when the response from the server is received, so the goal is reached, call again the function in order to reach a new goal.</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
Launch file</h1>
<p>In this package there is a launch file called <b><a class="el" href="my__launch_8py.html">my_launch.py</a></b>, which load and run the two components described before. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
